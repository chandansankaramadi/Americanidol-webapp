window.Swipe=function(c,b){var d=this;if(!c){return}this.element=c;c.className+=" swipe-active";this.browser={touch:(function(){return("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch})(),transitions:(function(){var e=document.createElement("swipe"),g=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var f in g){if(e.style[g[f]]!==undefined){return true}}return false})()};b=b||{};this.index=b.startSlide||0;this.speed=b.speed||300;this.callback=b.callback||function(){};this.transitionEnd=b.transitionEnd||function(){};this.delay=b.auto||0;this.cont=!!b.continuous;this.disableScroll=!!b.disableScroll;this.index=parseInt(this.index,10);this.setup();this.begin();var a=function(e){var g;return function f(){var j=this,i=arguments;function h(){e.apply(j,i);g=null}if(g){clearTimeout(g)}g=setTimeout(h,400)}};this.resize=a(function(){d.setup()});if(this.element.addEventListener){if(!!this.browser.touch){this.element.addEventListener("touchstart",this,false);this.element.addEventListener("touchmove",this,false);this.element.addEventListener("touchend",this,false)}if(!!this.browser.transitions){this.element.addEventListener("webkitTransitionEnd",this,false);this.element.addEventListener("msTransitionEnd",this,false);this.element.addEventListener("oTransitionEnd",this,false);this.element.addEventListener("transitionend",this,false)}window.addEventListener("resize",this.resize,false)}else{window.onresize=this.resize}};Swipe.prototype={setup:function(){this.slides=this.element.children;this.length=this.slides.length;this.cache=new Array(this.length);if(this.length<2){return}this.width=this.element.getBoundingClientRect().width||this.element.offsetWidth;if(!this.width){return}var c=0;var d=[[],[],[]];for(var b=this.length-1;b>-1;b--){var e=this.slides[b],a=e.getBoundingClientRect().height||e.offsetHeight;e.style.width=this.width+"px";e.setAttribute("data-index",b);e.style.visibility="visible";c=c<a?a:c;d[this.index>b?0:(this.index<b?2:1)].push(b)}if(!this.height){this.element.style.height=c+"px"}this._slide(d[0],-this.width,0,1);this._slide(d[1],0,0,1);this._slide(d[2],this.width,0,1)},kill:function(){this.delay=0;clearTimeout(this.interval);var b=[];for(var a=this.slides.length-1;a>=0;a--){this.slides[a].style.width="";b.push(a)}this._slide(b,0,0,1);var c=this.element;c.className=c.className.replace("swipe-active","");if(this.element.removeEventListener){if(!!this.browser.touch){this.element.removeEventListener("touchstart",this,false);this.element.removeEventListener("touchmove",this,false);this.element.removeEventListener("touchend",this,false)}if(!!this.browser.transitions){this.element.removeEventListener("webkitTransitionEnd",this,false);this.element.removeEventListener("msTransitionEnd",this,false);this.element.removeEventListener("oTransitionEnd",this,false);this.element.removeEventListener("transitionend",this,false)}window.removeEventListener("resize",this.resize,false)}else{window.onresize=null}},getPos:function(){return this.index},prev:function(a){this.delay=a||0;clearTimeout(this.interval);if(this.index){this.slide(this.index-1,this.speed)}else{if(this.cont){this.slide(this.length-1,this.speed)}}},next:function(a){this.delay=a||0;clearTimeout(this.interval);if(this.index<this.length-1){this.slide(this.index+1,this.speed)}else{if(this.cont){this.slide(0,this.speed)}}},begin:function(){var a=this;this.interval=(this.delay)?setTimeout(function(){a.next(a.delay)},this.delay):0},handleEvent:function(a){switch(a.type){case"touchstart":this.onTouchStart(a);break;case"touchmove":this.onTouchMove(a);break;case"touchend":this.onTouchEnd(a);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.onTransitionEnd(a);break;case"resize":this.setup();break}},onTouchStart:function(a){var b=this;b.start={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:Number(new Date())};b.isScrolling=undefined;b.deltaX=0},onTouchMove:function(a){var b=this;if(a.touches.length>1||a.scale&&a.scale!==1){return}b.deltaX=a.touches[0].pageX-b.start.pageX;if(typeof b.isScrolling=="undefined"){b.isScrolling=!!(b.isScrolling||Math.abs(b.deltaX)<Math.abs(a.touches[0].pageY-b.start.pageY))}if(!b.isScrolling){a.preventDefault();b.delay=0;clearTimeout(b.interval);b.deltaX=b.deltaX/((!b.index&&b.deltaX>0||b.index==b.length-1&&b.deltaX<0)?(Math.abs(b.deltaX)/b.width+1):1);b._slide([b.index-1,b.index,b.index+1],b.deltaX,0,-1)}else{if(b.disableScroll){a.preventDefault()}}},onTouchEnd:function(d){var f=this;var b=Number(new Date())-f.start.time<250&&Math.abs(f.deltaX)>20||Math.abs(f.deltaX)>f.width/2,a=!f.index&&f.deltaX>0||f.index==f.length-1&&f.deltaX<0,c=f.deltaX<0;if(!f.isScrolling){if(b&&!a){if(c){f._slide([f.index-1],-f.width,0,1);f._slide([f.index,f.index+1],-f.width,f.speed,0);f.index+=1}else{f._slide([f.index+1],f.width,0,1);f._slide([f.index-1,f.index],f.width,f.speed,0);f.index+=-1}f.callback(f.index,f.slides[f.index])}else{f._slide([f.index-1,f.index,f.index+1],0,f.speed,0)}}},onTransitionEnd:function(a){if(this._getElemIndex(a.target)==this.index){if(this.delay){this.begin()}this.transitionEnd(this.index,this.slides[this.index])}},slide:function(f,c){var e=this.index;if(e==f){return}var b=Math.abs(e-f)-1,d=Math.abs(e-f)/(e-f),a=[];while(b--){a.push((f>e?f:e)-b-1)}this._slide(a,this.width*d,0,1);this._slide([e,f],this.width*d,this.speed,0);this.index=f;this.callback(this.index,this.slides[this.index])},_slide:function(h,g,c,b){var f=this.slides,e=h.length;while(e--){var d=f[h[e]];if(d){if(this.browser.transitions){var a=d.style,i=(g+(b!=1?this.cache[h[e]]:0));a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=(c?c:0)+"ms";a.webkitTransform="translate3d("+i+"px,0,0)";a.msTransform=a.MozTransform=a.OTransform="translateX("+i+"px)"}else{this._animate(d,this.cache[h[e]],g+(b!=1?this.cache[h[e]]:0),c?c:0)}if(b==1){this.cache[h[e]]=g}else{if(b==0){this.cache[h[e]]+=g}}}}},_animate:function(a,g,f,b){if(!b){a.style.left=f+"px";return}var e=this,d=new Date(),c=setInterval(function(){var h=new Date()-d;if(h>b){a.style.left=f+"px";if(e._getElemIndex(a)==e.index){if(e.delay){e.begin()}e.transitionEnd(e.index,e.slides[e.index])}clearInterval(c);return}a.style.left=(((f-g)*(Math.floor((h/b)*100)/100))+g)+"px"},4)},_getElemIndex:function(a){return parseInt(a.getAttribute("data-index"),10)}};